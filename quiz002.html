<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>–ö–≤–∏–∑01: "–£ –º–µ–Ω—è –µ—Å—Ç—å.."</title>
<style>
  body { font-family: sans-serif; padding: 20px; background: #f7fafc; }
  h1 { font-size: 24px; margin-bottom: 20px; }
  .question { margin-bottom: 24px; }
  .options button {
    display: block;
    margin: 6px 0;
    padding: 10px;
    width: 100%;
    font-size: 16px;
    cursor: pointer;
  }
  .correct { background-color: #c8e6c9; }
  .incorrect { background-color: #ffcdd2; }
  #retry-btn {
    margin-top: 20px;
    padding: 12px 20px;
    font-size: 18px;
    cursor: pointer;
    display: none;
  }
  #progress {
    margin-bottom: 15px;
    font-weight: bold;
  }
  #result {
    margin-top: 30px;
    font-size: 20px;
    font-weight: bold;
  }
</style>
</head>
<body>
  <h1>–ö–≤–∏–∑01: "–£ –º–µ–Ω—è –µ—Å—Ç—å.."</h1>
  <div id="progress"></div>
  <div id="quiz-container"></div>
  <button id="retry-btn">–°–ª–µ–¥—É—é—â–∏–π —Ä–∞—É–Ω–¥</button>
  <div id="result"></div>

<script>
  // –ú–µ—Å—Ç–æ–∏–º–µ–Ω–∏—è —Å –∏–∫–æ–Ω–∫–∞–º–∏ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ —Ñ–æ—Ä–º–∞–º–∏
  const pronouns = [
    {icon: "üôã", text: "–£ –º–µ–Ω—è –µ—Å—Ç—å"},
    {icon: "üëà", text: "–£ —Ç–µ–±—è –µ—Å—Ç—å"},
    {icon: "ü´µ", text: "–£ –≤–∞—Å –µ—Å—Ç—å"},
    {icon: "üë´", text: "–£ –Ω–∞—Å –µ—Å—Ç—å"},
    {icon: "üë¶", text: "–£ –Ω–µ–≥–æ –µ—Å—Ç—å"},
    {icon: "üëß", text: "–£ –Ω–µ—ë –µ—Å—Ç—å"},
    {icon: "üßë‚Äçü§ù‚Äçüßë", text: "–£ –Ω–∏—Ö –µ—Å—Ç—å"},
  ];

  // –°—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ —Å –∏–∫–æ–Ω–∫–∞–º–∏ (–ø—Ä–∏–º–µ—Ä)
  const nouns = [
    {noun: "–∫–Ω–∏–≥–∞", icon: "üìö"},
    {noun: "—Ç–µ–ª–µ—Ñ–æ–Ω", icon: "üì±"},
    {noun: "–¥–æ–º", icon: "üè†"},
    {noun: "–±–∏–ª–µ—Ç—ã", icon: "üéüÔ∏è"},
    {noun: "–º—è—á", icon: "‚öΩ"},
    {noun: "—Å—É–º–∫–∞", icon: "üëú"},
    {noun: "–æ—á–∫–∏", icon: "üï∂Ô∏è"},
    {noun: "–∫–ª—é—á–∏", icon: "üîë"},
    {noun: "–¥–æ–∫—É–º–µ–Ω—Ç—ã", icon: "üìÑ"},
    {noun: "–∫–Ω–∏–≥–∞", icon: "üìñ"},
  ];

  const totalRounds = 3;
  let currentRound = 1;
  let currentQuestionIndex = 0;
  let score = 0;

  // –ü–µ—Ä–µ–º–µ—à–∞—Ç—å –º–∞—Å—Å–∏–≤
  function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
  }

  // –°–æ–∑–¥–∞—ë–º –≤–æ–ø—Ä–æ—Å—ã –¥–ª—è —Ä–∞—É–Ω–¥–∞ - –∫–∞–∂–¥—ã–π —Ä–∞–∑ –Ω–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –∏ –ø–æ—Ä—è–¥–æ–∫ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
  function createQuestions() {
    // –ë–µ—Ä—ë–º 7 —Å–ª—É—á–∞–π–Ω—ã—Ö —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–æ–≤ (–µ—Å–ª–∏ –º–µ–Ω—å—à–µ 7 - –¥—É–±–ª–∏—Ä—É–µ–º)
    let chosenNouns = shuffle([...nouns]).slice(0, 7);
    if (chosenNouns.length < 7) {
      // –¥—É–±–ª–∏—Ä—É–µ–º —Å –Ω–∞—á–∞–ª–∞, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
      chosenNouns = chosenNouns.concat(chosenNouns.slice(0, 7 - chosenNouns.length));
    }
    // –î–ª—è –∫–∞–∂–¥–æ–≥–æ –º–µ—Å—Ç–æ–∏–º–µ–Ω–∏—è —Å–æ–∑–¥–∞—ë–º –≤–æ–ø—Ä–æ—Å —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º
    return pronouns.map((pron, i) => {
      // –í–∞—Ä–∏–∞–Ω—Ç—ã - –≤—Å–µ –º–µ—Å—Ç–æ–∏–º–µ–Ω–∏—è –≤ –ø–µ—Ä–µ–º–µ—à–∞–Ω–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
      const options = shuffle(pronouns.map(p => ({text: p.text, isCorrect: p.text === pron.text})));
      return {
        prompt: `${pron.icon} _____ ${chosenNouns[i].noun} ${chosenNouns[i].icon}.`,
        options: options
      };
    });
  }

  let questions = createQuestions();

  const container = document.getElementById("quiz-container");
  const progressDiv = document.getElementById("progress");
  const retryBtn = document.getElementById("retry-btn");
  const resultDiv = document.getElementById("result");

  function showQuestion() {
    container.innerHTML = "";
    resultDiv.textContent = "";
    retryBtn.style.display = "none";

    const q = questions[currentQuestionIndex];
    const div = document.createElement("div");
    div.className = "question";

    const p = document.createElement("p");
    p.textContent = `–í–æ–ø—Ä–æ—Å ${currentQuestionIndex + 1} –∏–∑ ${pronouns.length} (–†–∞—É–Ω–¥ ${currentRound} –∏–∑ ${totalRounds})`;
    div.appendChild(p);

    const promptP = document.createElement("p");
    promptP.style.fontWeight = "bold";
    promptP.textContent = q.prompt;
    div.appendChild(promptP);

    const optionsDiv = document.createElement("div");
    optionsDiv.className = "options";

    q.options.forEach(opt => {
      const btn = document.createElement("button");
      btn.textContent = opt.text;
      btn.onclick = () => {
        if (btn.disabled) return;
        // –ë–ª–æ–∫–∏—Ä—É–µ–º –≤—Å–µ –∫–Ω–æ–ø–∫–∏
        Array.from(optionsDiv.children).forEach(b => b.disabled = true);
        if (opt.isCorrect) {
          btn.classList.add("correct");
          score++;
        } else {
          btn.classList.add("incorrect");
          // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
          Array.from(optionsDiv.children).forEach(b => {
            if (b.textContent === q.options.find(o => o.isCorrect).text) {
              b.classList.add("correct");
            }
          });
        }

        // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –≤–æ–ø—Ä–æ—Å—É —á–µ—Ä–µ–∑ 1.2 —Å–µ–∫—É–Ω–¥—ã
        setTimeout(() => {
          currentQuestionIndex++;
          if (currentQuestionIndex < pronouns.length) {
            showQuestion();
          } else {
            if (currentRound < totalRounds) {
              retryBtn.style.display = "inline-block";
              progressDiv.textContent = `–†–∞—É–Ω–¥ ${currentRound} –∑–∞–≤–µ—Ä—à—ë–Ω. –ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤: ${score} –∏–∑ ${pronouns.length * currentRound}. –ù–∞–∂–º–∏—Ç–µ "–°–ª–µ–¥—É—é—â–∏–π —Ä–∞—É–Ω–¥".`;
            } else {
              showFinalResult();
            }
          }
        }, 1200);
      };
      optionsDiv.appendChild(btn);
    });

    div.appendChild(optionsDiv);
    container.appendChild(div);

    // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
    progressDiv.textContent = `–í–æ–ø—Ä–æ—Å ${currentQuestionIndex + 1} –∏–∑ ${pronouns.length} (–†–∞—É–Ω–¥ ${currentRound} –∏–∑ ${totalRounds})`;
  }

  function showFinalResult() {
    container.innerHTML = "";
    progressDiv.textContent = "";
    retryBtn.style.display = "none";

    const totalQuestions = pronouns.length * totalRounds;
    const percent = Math.round((score / totalQuestions) * 100);

    if (percent >= 80) {
      resultDiv.textContent = `–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞! –í—ã –æ—Ç–≤–µ—Ç–∏–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞ ${score} –∏–∑ ${totalQuestions} (${percent}%). –ú–æ–∂–Ω–æ –¥–≤–∏–≥–∞—Ç—å—Å—è –¥–∞–ª—å—à–µ.`;
    } else {
      resultDiv.textContent = `–í—ã –æ—Ç–≤–µ—Ç–∏–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞ ${score} –∏–∑ ${totalQuestions} (${percent}%). –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å, —á—Ç–æ–±—ã —É–ª—É—á—à–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç.`;
      retryBtn.style.display = "inline-block";
      retryBtn.textContent = "–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ";
    }
  }

  retryBtn.onclick = () => {
    if (currentRound < totalRounds) {
      currentRound++;
      currentQuestionIndex = 0;
      questions = createQuestions();
      retryBtn.style.display = "none";
      showQuestion();
    } else {
      // –°–±—Ä–æ—Å
      currentRound = 1;
      currentQuestionIndex = 0;
      score = 0;
      retryBtn.textContent = "–°–ª–µ–¥—É—é—â–∏–π —Ä–∞—É–Ω–¥";
      questions = createQuestions();
      resultDiv.textContent = "";
      showQuestion();
    }
  };

  // –ó–∞–ø—É—Å–∫
  showQuestion();
</script>
</body>
</html>
